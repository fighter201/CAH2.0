<!DOCTYPE html>
<html>
	<head>
		<title>Create game | Cards Against Humanity</title>
		<link rel="icon" href="img/icon.png" type="images/x-icon">
		<meta charset="utf-8">
		
		<link rel="stylesheet" href="../css/cah2.css">
		<link rel="stylesheet" href="../css/createGame.css">
		<link rel="stylesheet" href="../css/checkbox.css">
		
		<script defer src="../js/createGame_functionality.js"></script>
		
		<script src="/socket.io/socket.io.js"></script>

		<script>
			var socket=io('/DB');
			const lobbyUrl = "/waitingGamestart.html";
		</script>
		<script>
			function createLobby() {
				console.log('input content: ' + document.getElementById('gameID').value);
        
				if (document.getElementById('gameID').value=='' || document.getElementById('gameID').value.includes(' ')) {
					console.log('no valid gameID');
					return;
				}
				// var settings = extractSettings();

				var gameID = document.getElementById('gameID').value;
				var userID = 'default user';
				var settings = [3, '5min'];
				socket.emit('createGame', userID, gameID, settings);
				socket.on('duplicatedGameID', function(duplicate) {
					if (!duplicate){
						window.sessionStorage.setItem('gameID', gameID);
						window.sessionStorage.setItem('master', true);
						window.location.href = lobbyUrl;
					} else {
						alert('duplicated gameID');
					}
				});
			}

			function extractSettings() {
				//TODO
				return array();
			}
		</script>
	</head>
	
	<body>
		<header>
			<h1>Cards Against Humanity</h1>
		</header>
		<main>
			<div id='content'>
				<ul>
					<li><label for="gameName">Choose a name for the game:</label>
						<input id='gameName' name="gameName" type="text"></li>
					<li><label for="maxPlayer">Maximum player number:</label>
						<select id='maxPlayer' name="maxPlayer">
							<option selected>3</option>
							<option>4</option>
							<option>5</option>
							<option>6</option>
							<option>7</option>
							<option>8</option>
							<option>9</option>
							<option>10</option>
						</select></li>
					<li><label for="maxPoints">Round ends at</label>
						<input id='maxPoints' name="maxPoints" type="text">
						<label for="maxPoints">points</label></li>
					<li><span>Choose your card sets</span>
						<ul>
							<li><input id='set1' name="set1" type="checkBox">
								<label for="set1">First set</label></li>
							<li><input id='set2' name="set2" type="checkBox">
								<label for="set2">Second set</label></li>
							<!--Card sets werden Ã¼ber javaScript geladen-->
						</ul></li>
					<li><label for="password">Set a password</label>
						<input id='password' name="password" type="text"></li>
				</ul>
				<button id="apply" onclick="createLobby()">Create game</button>
			</div>
		</main>
		<footer>
			<ul>
			    <li><a href="http://www.lysin-games.com/agb">Allgemeine Gesch&auml;ftsbedingungen</a></li>
			    <li><a href="http://www.lysin-games.com/datenschutz">Datenschutzerkl&auml;rung</a></li>
				<li><a href="http://www.lysin-games.com/impressum">Impressum</a></li>
			</ul>
		</footer>
	</body>
</html>
